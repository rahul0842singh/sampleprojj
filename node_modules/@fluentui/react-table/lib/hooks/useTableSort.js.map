{"version":3,"mappings":"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","names":["useControllableState","noop","undefined","defaultTableSortState","getSortDirection","setColumnSort","sort","rows","sortColumn","sortDirection","toggleColumnSort","useTableSort","options","tableState","useTableSortState","columns","sortState","defaultSortState","onSortChange","sorted","setSorted","initialState","defaultState","state","e","columnId","s","newState","nextSortColumn","nextSortDirection","slice","a","b","sortColumnDef","find","column","compare","mod","item"],"sourceRoot":"../src/","sources":["packages/react-components/react-table/src/hooks/useTableSort.ts"],"sourcesContent":["import * as React from 'react';\nimport { useControllableState } from '@fluentui/react-utilities';\nimport type {\n  TableColumnId,\n  TableRowData,\n  SortState,\n  TableSortState,\n  TableFeaturesState,\n  UseTableSortOptions,\n} from './types';\n\nconst noop = () => undefined;\n\nexport const defaultTableSortState: TableSortState<unknown> = {\n  getSortDirection: () => 'ascending',\n  setColumnSort: noop,\n  sort: <TRowState extends TableRowData<unknown>>(rows: TRowState[]) => [...rows],\n  sortColumn: undefined,\n  sortDirection: 'ascending',\n  toggleColumnSort: noop,\n};\n\nexport function useTableSort<TItem>(options: UseTableSortOptions) {\n  // False positive, these plugin hooks are intended to be run on every render\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  return (tableState: TableFeaturesState<TItem>) => useTableSortState(tableState, options);\n}\n\nexport function useTableSortState<TItem>(\n  tableState: TableFeaturesState<TItem>,\n  options: UseTableSortOptions,\n): TableFeaturesState<TItem> {\n  const { columns } = tableState;\n  const { sortState, defaultSortState, onSortChange } = options;\n\n  const [sorted, setSorted] = useControllableState<SortState>({\n    initialState: {\n      sortDirection: 'ascending' as const,\n      sortColumn: undefined,\n    },\n    defaultState: defaultSortState,\n    state: sortState,\n  });\n\n  const { sortColumn, sortDirection } = sorted;\n\n  const toggleColumnSort = (e: React.SyntheticEvent, columnId: TableColumnId | undefined) => {\n    setSorted(s => {\n      const newState = { ...s, sortColumn: columnId };\n      if (s.sortColumn === columnId) {\n        newState.sortDirection = s.sortDirection === 'ascending' ? 'descending' : 'ascending';\n      } else {\n        newState.sortDirection = 'ascending';\n      }\n\n      onSortChange?.(e, newState);\n      return newState;\n    });\n  };\n\n  const setColumnSort: TableSortState<TItem>['setColumnSort'] = (e, nextSortColumn, nextSortDirection) => {\n    const newState = { sortColumn: nextSortColumn, sortDirection: nextSortDirection };\n    onSortChange?.(e, newState);\n    setSorted(newState);\n  };\n\n  const sort = <TRowState extends TableRowData<TItem>>(rows: TRowState[]) => {\n    return rows.slice().sort((a, b) => {\n      const sortColumnDef = columns.find(column => column.columnId === sortColumn);\n      if (!sortColumnDef?.compare) {\n        return 0;\n      }\n\n      const mod = sortDirection === 'ascending' ? 1 : -1;\n      return sortColumnDef.compare(a.item, b.item) * mod;\n    });\n  };\n\n  const getSortDirection: TableSortState<TItem>['getSortDirection'] = (columnId: TableColumnId) => {\n    return sortColumn === columnId ? sortDirection : undefined;\n  };\n\n  return {\n    ...tableState,\n    sort: {\n      sort,\n      sortColumn,\n      sortDirection,\n      setColumnSort,\n      toggleColumnSort,\n      getSortDirection,\n    },\n  };\n}\n"]}