{"version":3,"mappings":"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","names":["applyTriggerPropsToChildren","getTriggerChild","mergeCallbacks","useMergedRefs","useEventCallback","useModalAttributes","usePopoverContext_unstable","useARIAButtonProps","Escape","usePopoverTrigger_unstable","props","children","disableButtonEnhancement","child","open","context","setOpen","toggleOpen","triggerRef","openOnHover","openOnContext","triggerAttributes","onContextMenu","e","preventDefault","onClick","onKeyDown","key","stopPropagation","onMouseEnter","onMouseLeave","contextMenuProps","ref","triggerChildProps","ariaButtonTriggerChildProps","type"],"sourceRoot":"../src/","sources":["packages/react-components/react-popover/src/components/PopoverTrigger/usePopoverTrigger.ts"],"sourcesContent":["import * as React from 'react';\nimport {\n  applyTriggerPropsToChildren,\n  getTriggerChild,\n  mergeCallbacks,\n  useMergedRefs,\n  useEventCallback,\n} from '@fluentui/react-utilities';\nimport { useModalAttributes } from '@fluentui/react-tabster';\nimport { usePopoverContext_unstable } from '../../popoverContext';\nimport type { PopoverTriggerProps, PopoverTriggerState } from './PopoverTrigger.types';\nimport { useARIAButtonProps } from '@fluentui/react-aria';\nimport { Escape } from '@fluentui/keyboard-keys';\n\n/**\n * Create the state required to render PopoverTrigger.\n *\n * The returned state can be modified with hooks such as usePopoverTriggerStyles,\n * before being passed to renderPopoverTrigger_unstable.\n *\n * @param props - props from this instance of PopoverTrigger\n */\nexport const usePopoverTrigger_unstable = (props: PopoverTriggerProps): PopoverTriggerState => {\n  const { children, disableButtonEnhancement = false } = props;\n  const child = getTriggerChild(children);\n\n  const open = usePopoverContext_unstable(context => context.open);\n  const setOpen = usePopoverContext_unstable(context => context.setOpen);\n  const toggleOpen = usePopoverContext_unstable(context => context.toggleOpen);\n  const triggerRef = usePopoverContext_unstable(context => context.triggerRef);\n  const openOnHover = usePopoverContext_unstable(context => context.openOnHover);\n  const openOnContext = usePopoverContext_unstable(context => context.openOnContext);\n  const { triggerAttributes } = useModalAttributes();\n\n  const onContextMenu = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnContext) {\n      e.preventDefault();\n      setOpen(e, true);\n    }\n  };\n\n  const onClick = (e: React.MouseEvent<HTMLElement>) => {\n    if (!openOnContext) {\n      toggleOpen(e);\n    }\n  };\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\n    if (e.key === Escape && open) {\n      setOpen(e, false);\n      // stop propagation to avoid conflicting with other elements that listen for `Escape`\n      // e,g: Dialog, Menu\n      e.stopPropagation();\n    }\n  };\n\n  const onMouseEnter = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, true);\n    }\n  };\n\n  const onMouseLeave = (e: React.MouseEvent<HTMLElement>) => {\n    if (openOnHover) {\n      setOpen(e, false);\n    }\n  };\n\n  const contextMenuProps = {\n    ...triggerAttributes,\n    'aria-expanded': `${open}`,\n    ...child?.props,\n    onMouseEnter: useEventCallback(mergeCallbacks(child?.props.onMouseEnter, onMouseEnter)),\n    onMouseLeave: useEventCallback(mergeCallbacks(child?.props.onMouseLeave, onMouseLeave)),\n    onContextMenu: useEventCallback(mergeCallbacks(child?.props.onContextMenu, onContextMenu)),\n    ref: useMergedRefs(triggerRef, child?.ref),\n  } as const;\n\n  const triggerChildProps = {\n    ...contextMenuProps,\n    onClick: useEventCallback(mergeCallbacks(child?.props.onClick, onClick)),\n    onKeyDown: useEventCallback(mergeCallbacks(child?.props.onKeyDown, onKeyDown)),\n  };\n\n  const ariaButtonTriggerChildProps = useARIAButtonProps(\n    child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n    triggerChildProps,\n  );\n\n  return {\n    children: applyTriggerPropsToChildren(\n      props.children,\n      useARIAButtonProps(\n        child?.type === 'button' || child?.type === 'a' ? child.type : 'div',\n        openOnContext ? contextMenuProps : disableButtonEnhancement ? triggerChildProps : ariaButtonTriggerChildProps,\n      ),\n    ),\n  };\n};\n"]}